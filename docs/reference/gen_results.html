<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate results — gen_results • MultiEWCE</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generate results — gen_results" />
<meta property="og:description" content="Generates EWCE results on multiple gene lists in parallel by calling
ewce_para. It allows you to stop the analysis and then continue later
from where you left off as it checks the results output directory for finished
gene lists and removes them from the input. It also excludes gene lists with
less than 4 unique genes (which cause errors in ewce analysis)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MultiEWCE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MultiEWCE.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/neurogenomics/MultiEWCE/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate results</h1>
    <small class="dont-index">Source: <a href='https://github.com/neurogenomics/MultiEWCE/blob/master/R/gen_results.R'><code>R/gen_results.R</code></a></small>
    <div class="hidden name"><code>gen_results.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates EWCE results on multiple gene lists in parallel by calling
<code>ewce_para</code>. It allows you to stop the analysis and then continue later
from where you left off as it checks the results output directory for finished
gene lists and removes them from the input. It also excludes gene lists with
less than 4 unique genes (which cause errors in ewce analysis).</p>
    </div>

    <pre class="usage"><span class='fu'>gen_results</span><span class='op'>(</span>
  <span class='va'>ctd</span>,
  <span class='va'>gene_data</span>,
  <span class='va'>list_names</span>,
  <span class='va'>background_genes</span>,
  list_name_column <span class='op'>=</span> <span class='st'>"Phenotype"</span>,
  gene_column <span class='op'>=</span> <span class='st'>"Gene"</span>,
  results_dir <span class='op'>=</span> <span class='st'>"results"</span>,
  overwrite_past_analysis <span class='op'>=</span> <span class='cn'>FALSE</span>,
  reps <span class='op'>=</span> <span class='fl'>10</span>,
  annotLevel <span class='op'>=</span> <span class='fl'>1</span>,
  genelistSpecies <span class='op'>=</span> <span class='st'>"human"</span>,
  sctSpecies <span class='op'>=</span> <span class='st'>"human"</span>,
  cores <span class='op'>=</span> <span class='fl'>1</span>,
  MergeResults <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ctd</th>
      <td><p>The Cell type data file for EWCE analysis (see EWCE docs)</p></td>
    </tr>
    <tr>
      <th>gene_data</th>
      <td><p>The dataframe containing gene list names and associated genes
(see docs for get_gene_list for more info).</p></td>
    </tr>
    <tr>
      <th>list_names</th>
      <td><p>The names of each gene list (e.g. "Abnormality of nervous system
may be the name of a phenotype assocated gene list)</p></td>
    </tr>
    <tr>
      <th>background_genes</th>
      <td><p>A character vector of background genes (see EWCE docs)</p></td>
    </tr>
    <tr>
      <th>list_name_column</th>
      <td><p>The name of the column in gene_data that contains the
gene list names, (e.g. the column may be called "Phenotype" if dealing with
phenotype associated gene lists)</p></td>
    </tr>
    <tr>
      <th>gene_column</th>
      <td><p>The name of the column containing genes in the gene_data
dataframe. Typically this column is called "Gene"</p></td>
    </tr>
    <tr>
      <th>results_dir</th>
      <td><p>the desired direcory to save results (e.g. "results")</p></td>
    </tr>
    <tr>
      <th>overwrite_past_analysis</th>
      <td><p>overwrite previous results in the results dir (bool)</p></td>
    </tr>
    <tr>
      <th>reps</th>
      <td><p>The number of bootstrap reps for EWCE (see ewce docs) (int)</p></td>
    </tr>
    <tr>
      <th>annotLevel</th>
      <td><p>The level of cell specificity to select from the CTD,
See EWCE docs (int)</p></td>
    </tr>
    <tr>
      <th>genelistSpecies</th>
      <td><p>The species ("human"/"mouse") of the gene lists (string)</p></td>
    </tr>
    <tr>
      <th>sctSpecies</th>
      <td><p>The species ("human"/"mouse") of the CTD data</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>The number of cores to run in parallel (int)</p></td>
    </tr>
    <tr>
      <th>MergeResults</th>
      <td><p>return merged to single data.frame as a .rds.
Note: The function will return merged dataframe even if FALSE (bool)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If MergeResults is TRUE, it will return all results as a datframe. If
FALSE nothing will be returned, but the individual results will still be saved
in the results directory.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The gene_data should be a data frame that contains a column of gene
list names (e.g. the column may be called "Phenotype"), and a column of
genes (e.g. "Gene"). For example:</p><table class='table'>
<tr><td>Phenotype</td><td>Gene</td></tr>
<tr><td>"Abnormal heart"</td><td>gene X</td></tr>
<tr><td>"Abnormal heart"</td><td>gene Y</td></tr>
<tr><td>"Poor vision"</td><td>gene Z</td></tr>
<tr><td>"Poor vision"</td><td>gene Y</td></tr>
<tr><td>etc...</td><td></td></tr>
</table>



<p>For more information on this see docs for get_gene_list (<code><a href='get_gene_list.html'>?get_gene_list</a></code>)</p>
<p>If <code>MergeResutls == TURE</code>, the function will return a dataframe of all results.
No multiple testing corrections are applied to this so it is recommended that
they are done after, for example:
<code>all_results$q &lt;- stats::p.adjust(all_results$p, method = "BH")</code></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>gene_data</span> <span class='op'>&lt;-</span> <span class='fu'>HPOExplorer</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/HPOExplorer/man/load_phenotype_to_genes.html'>load_phenotype_to_genes</a></span><span class='op'>(</span><span class='st'>"phenotype_to_genes.txt"</span><span class='op'>)</span>
<span class='va'>ctd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='load_example_CTD.html'>load_example_CTD</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in load_example_CTD(): could not find function "load_example_CTD"</span></div><div class='input'><span class='va'>list_names</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>gene_data</span><span class='op'>$</span><span class='va'>Phenotype</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span><span class='op'>]</span>
<span class='va'>background_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>gene_data</span><span class='op'>$</span><span class='va'>Gene</span><span class='op'>)</span>
<span class='va'>list_name_column</span> <span class='op'>&lt;-</span> <span class='st'>"Phenotype"</span>
<span class='va'>gene_column</span> <span class='op'>&lt;-</span> <span class='st'>"Gene"</span>
<span class='va'>results_dir</span> <span class='op'>&lt;-</span> <span class='st'>"results"</span>
<span class='va'>overwrite_past_analysis</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
<span class='va'>MergeResults</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
<span class='va'>reps</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
<span class='va'>annotLevel</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>genelistSpecies</span> <span class='op'>&lt;-</span> <span class='st'>"human"</span>
<span class='va'>sctSpecies</span> <span class='op'>&lt;-</span> <span class='st'>"human"</span>
<span class='va'>cores</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>

<span class='va'>all_results</span> <span class='op'>&lt;-</span><span class='fu'>MultiEWCE</span><span class='fu'>::</span><span class='fu'>gen_results</span><span class='op'>(</span><span class='va'>ctd</span>, <span class='va'>gene_data</span>, <span class='va'>list_names</span>, <span class='va'>background_genes</span>,
                                     <span class='va'>list_name_column</span>, <span class='va'>gene_column</span>, <span class='va'>results_dir</span>,
                                     <span class='va'>overwrite_past_analysis</span>, <span class='va'>reps</span>, <span class='va'>annotLevel</span>,
                                     <span class='va'>genelistSpecies</span>, <span class='va'>sctSpecies</span>, <span class='va'>cores</span>,
                                     <span class='va'>MergeResults</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in rownames(ctd[[1]]$specificity_quantiles): object 'ctd' not found</span></div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robert Gordon-Smith, Brian Schilder, Nathan Skene.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


